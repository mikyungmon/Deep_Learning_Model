# FaceNet #

- 2015년에 처음 나온 논문으로 얼굴 인식 모델에서 가장 중요한 개념인 triplet loss가 처음 등장된 논문이며 7000번이 넘게 인용되었다.

- CNN feature를 L2 norm + triplet loss를 사용하는 새로운 face recognition 방법론을 제안한다.

- 이를 학습시키기 위해서는 hard triplet seleciton이 중요함을 강조한다.

## Abstract ## 

- 얼굴 인식 분야는 많은 발전이 있었음에도 불구하고 대규모로 얼굴 확인 및 인식을 효율적으로 구현하는 것은 현재 접근 방식에 문제를 제시한다.

- 해당 논문에서는 얼굴 이미지로부터 거리가 얼굴 유사성의 척도에 직접적으로 대응하는 컴팩트한 유클리드 공간으로의 매핑을 직접 학습하는 FaceNet이라는 시스템을 제안한다.

- 이 공간이 생성되면 FaceNet 임베딩을 특징 벡터로 사용하는 표준 기술을 사용하여 얼굴 인식, 검증 및 클러스터링과 같은 작업을 쉽게 구현할 수 있다.

- 이 방법은 기존 접근 방법에서와 같이 중간 Bottleneck Layer가 아니라 임베딩 자체를 직접 최적화하도록 훈련된 딥 컨볼루션 네트워크를 사용한다.

- train을 위해 새로운 온라인 triplet mining 방법을 사용하여 생성된 대략적 정렬된 매칭/비매칭 얼굴 패치의 triplet을 사용한다.

- 해당 접근 방식의 이점은 뛰어난 representational efficiency이다. 얼굴당 128 바이트만 사용하여 최첨단 얼굴 인식을 달성한다.

- labeled Faces in the Wild(LFW) 데이터 셋에서 99.63%의 정확도를 달성했으며 YouTube Faces DB에서는 95.12%를 달성했다.

## Introduction ## 

- 이 논문에서는 Face-Verification(동일인물인지), Recognition(누구인지), Clustering(공통되는 사람들 찾기) 세가지의 통합 시스템을 소개한다.

- 이 방법은 이미지마다 Deep Conv Net을 사용하여 이미지당 유클리드 임베딩을 학습하는 것을 기반으로 한다.

- 제곱된 L2 거리가 얼굴 유사성에 직접 대응하도록 훈련되었다(유클리드 거리의 제곱은 얼굴 유사도와 곧바로 일치한다). 즉 같은 사람의 얼굴은 적은 거리를 가지고 다른 사람일 경우 큰 거리를 가지게 된다.

![image](https://user-images.githubusercontent.com/66320010/146324530-a1892169-4c8a-4439-92b1-721a9650a552.png)

- FaceNet은 얼굴 사진에서 그 사람에 대한 특징 값(=feature, embedding결과)를 구해주는 모델로 이 값을 활용하여 값들간의 거리를 통해 이미지에 대한 identification, clustering을 할 수 있게 한다.

- 이 임베딩이 생성되면 앞서 언급한 작업들이 간단해진다. 인식은 k-NN 분류 문제가 되고 클러스터링은 k-mean 또는 응집 클러스터링과 같은 기존 기술을 사용하여 달성할 수 있다.

- 딥 네트워크를 기반으로 하는 이전의 얼굴 인식 접근 방식은 알려진 얼굴 ID 세트에 대해 훈련된 분류 계층을 사용한 다음에 사용된 ID세트를 넘어 인식을 일반화하는 방법으로는 중간 bottleneck layer를 사용한다.

- 이 접근 방식의 단점은 간접성과 비효율성이다. bottleneck representation이 새로운 얼굴에 잘 일반화되기를 바라야한다.

- bottlneck layer를 사용하면 얼굴 당 표현의 크기가 매우 커진다(1000차원). 일부 최근 연구에서는 PCA를 사용하여 이 차원을 감소시켰지만 이것은 네트워크의 한 계층에서 쉽게 학습할 수 있는 선형 변환이다.

- 이러한 접근 방식과 대조적으로 FaceNet은 LMNN을 기반으로 하는 triplet 기반 손실함수를 사용하여 출력을 128차원 임베딩으로 직접 훈련한다.

- triplet은 2개의 일치하는 얼굴과 하나의 다른 얼굴로 이루어져 있으며 loss는 distance margin으로 일치하는 쪽을 불일치하는 쪽으로부터 분리해내는 데 초점을 두고 있다.

- 썸네일(thumbnails)은 얼굴 영역의 딱 맞게 자르기이며 배율 및 변환이 수행되는 것 외에는 2D 또는 3D 정렬이 수행되지 않는다.

- 사용할 triplet을 선택하는 것은 좋은 성과를 달성하는데 매우 중요하며 커리큘럼 학습에서 영감을 받아 네트워크가 훈련됨에 따라 triplet의 난이도를 지속적으로 증가시키는 새로운 온라인 negative exemplar mining 전략을 제시한다.

- 클러스터링 정확도를 개선하기 위해서는 한 사람의 임베딩을 위한 구형 클러스터를 권장하는 hard positive mining 기술도 탐색한다(hard positive : 같은 사람인데 다르게 보이는 사람).

## Related work ## 

- 해당 논문의 접근 방식은 얼굴의 픽셀에서 직접 표현을 학습하는 순수 데이터 기반 방법이다. 

- 엔지니어링된 기능을 사용하는 대신 지정된 얼굴의 대규모 데이터 셋을 사용하여 포즈, 조명 및 기타 변형 조건에 대한 적절한 불변성을 얻는다.

- 이 논문에서는 최근 컴퓨터 비전 커뮤니티에서 큰 성공을 거둔 두 가지 다른 심층 네트워크 아키텍처를 탐구하며 둘 다 딥 컨볼루션 네트워크이다.

- 첫 번째 아키텍처는 Zeiler&Fergus Model에 기반을 둔 다중 interleave된 컨볼루션 레이어, 비선형 활성화, 로컬 reponse 정규화 및 max pooling layer로 구성된 모델을 기반으로 한다. 여기에 1 * 1 * d 컨볼루션 레이어를 추가하여 사용한다.

- 두 번째 아키텍처는 Inception 모델을 기반으로 한다. 

이러한 네트워크는 여러 다른 컨볼루션 및 pooling layer를 병렬로 실행하고 response를 연결하는 혼합 레이어를 사용한다.

이러한 모델이 매개변수 수를 최대 20배까지 줄일 수 있고 유사한 성능에 필요한 FLOPS 수를 줄일 수 있다는 것을 발견하였다. 

(FLOPS : 플롭스(FLOPS, FLoating point Operations Per Second)는 컴퓨터의 성능을 수치로 나타낼 때 주로 사용되는 단위이다. 초당 부동소수점 연산이라는 의미로 컴퓨터가 1초동안 수행할 수 있는 부동소수점 연산의 횟수를 기준으로 삼는다)

## Method ## 

FaceNet은 심층 컨볼루션 네트워크를 사용한다. 

Zeiler&Fergus 스타일 네트워크와 최근 Inception 유형 네트워크의 두 가지 아키텍처에 대해 논의한다.

해당 논문의 접근 방식의 가장 중요한 부분은 전체 시스템의 종단 간 학습에 있다. 

이를 위해 얼굴 확인, 인식 및 클러스터링에서 달성하고자 하는 것을 직접 반영하는 triplet loss를 사용한다. 

즉, 우리는 feature space속의 이미지 x로부터 embedding f(x)를 얻어서 같은 사람이면 sqaured distance가 작게, 다른 사람이면 크게 한다.

비록 다른 loss와 직접적인 비교는 하지 않았지만 손실이 하나의 ID의 모든 얼굴이 임베딩 공간의 단일 지점에 투영되도록 권장하기 때문에 triplet loss가 얼굴검증에 더 적합하다고 생각한다는게 저자들의 의견이다.

그러나 triplet loss는 한 사람과 다른 모든 얼굴로부터 나온 모든 얼굴쌍에 대해 margin을 적용하려고 한다. 이를 통해 하나의 ID에 대한 얼굴이 다양하게 존재하는 동시에 다른 ID에 대한 거리 및 식별 가능성을 계속 적용할 수 있다.

### 1. Triplet Loss ### 

d
 
## 논문 링크 ## 

https://arxiv.org/pdf/1503.03832.pdf






